<div class="container">
    <div class="row">
        <div class="col-8 col-md-8 col-sm-6">
           <%# left starts %>
           <%# left starts %>
           <%# left starts %>
           <%# left starts %>
           <%# left starts %>



           <%# new post %>
           <%# new post %>
           <%# new post %>
           <%# new post %>
            <% if @membership.present? %>
    <div class="container card shadow p-3 mb-5 bg-white rounded m-4" >
                <h2>New Post</h2>
                    <%= form_with(model:[@group, @group_post]) do |f| %>
                    <div class="form-group">
                    <%= f.label :body %>
                    <br>
                    <%= f.rich_text_area :body, cols: 50, rows: 5, class:"form-control" %>
                    <br>
                    </div>
                    <div class="form-group">
                    <%= f.label :image %>
                    <br>
                    <%= f.file_field :image, class:"form-control" %> 
                    <%= content_tag(:i, nil, id: 'audio-record-button', class:'bi bi-mic microphone-icon') %>
                    <br>
                    </div>
              
                    <%= f.submit "Post", class:"ui primary button" %>
               
                <% end %>
                <% end %>
        </div>

           <%# new post %>
           <%# new post %>
           <%# new post %>
           <%# new post %>
 <div class="">
    <% @group_posts.each do |group_post| %>
    <div class="container card shadow p-3 mb-5 bg-white rounded m-4" >
        <div class="ui comments">
        <div class="comment">
                <a class="avatar">
                <img src="https://i.pravatar.cc/">
                </a>
                <div class="content">
                <a class="author">
                <%= link_to user_path(group_post.user.id), class:"text-dark " do %>
                <%= group_post.user.full_name%>
                <% end %>
                </a>
                <div class="metadata">
                    <span class="date"><%= time_ago_in_words(group_post.created_at) %> ago</span>
                </div>
                </div>
        </div>
        </div>
        <div><%= group_post.body %></div>
        <%   if group_post.image.attached? && group_post.image.content_type.in?(%w[image/jpeg image/png image/gif])%>
             <%= link_to image_tag(group_post.image_as_thumbnail), group_post.image %>
        <% end %>
       <br>
        <small>
        <% like = group_post.likes.find_by(user: current_user) %>
            <% if like.present? %>

                <%= button_to "❤️", like_path(like), method: :delete, class:"ui icon button" %>
                
                <% elsif user_signed_in? %>
               



                <%= button_to "🤍", group_group_post_likes_path(@group.id, group_post.id), method: :post, class:"ui icon button" %>



            <% end%>
        </small>
        <% if group_post.likes.present? %>
        <span><%= group_post.likes.count%> <%= 'Like'.pluralize(group_post.likes.count) %></span>
        <% end %>
        </hr>
        </hr>
       


        <div class="">
            
             <%= form_with(model:[@group, group_post, @comment]) do |f| %>
            <div class="form-group">
             <%= f.label "Leave a Comment" %>
             <br>
             <%= f.text_area :body, cols: 50, rows: 1, class:"form-control" %>
              <br>
             </div>
          <%= f.submit "Post", class:"ui primary button" %>

            <div class="ui comments">
               
    <%# Comment Section starts%>
        <% if group_post.comments.any? %>
            <h3 class="ui dividing header"></h3>
             <% group_post.comments.each do |comment|%>

            <div class="comment">
                <a class="avatar">
                <img src="https://i.pravatar.cc/">
                </a>
                <div class="content">
                <a class="author">
                <%= link_to user_path(comment.user.id) do %>
                <%= comment.user.full_name%></a>
                <% end %>
               
                <div class="metadata">
                    <span class="date"><%= time_ago_in_words(comment.created_at) %> ago</span>
                </div>
                <div class="text">
                    <%= comment.body %>
                </div>
                </div>
            </div>
            <% end %>
        <% end %>
    <%# Comment Section ends %>



</div>
    <% end %>
        </div>
    </div>
<% end %>
</div>





       





            <%# left ends %>
            <%# left ends %>
            <%# left ends %>
            <%# left ends %>
            <%# left ends %>
        </div>
        <div class="col-4 col-md-4 col-sm-6">
           <%# right starts %>
           <%# right starts %>
           <%# right starts %>
           <%# right starts %>
           <%# right starts %>
        <%#---------- group info starts ---------%>
        <div class="card container card shadow p-3 mb-5 bg-white rounded m-4" >
            <h2><%= @group.title %></h2>
            <p><%= @group.description %></p>
            <p>Created by <%= @group.user.full_name %></p>
            
            <span><i class="map pin icon"></i>Vancouver BC, Canada</span>
            <br>
            <small>
            <% if @membership.present? %>
                <%= button_to "Leave Group", membership_path(@membership), method: :delete, class:"ui red button btn btn-danger text-uppercase p-3" %>
                <% elsif user_signed_in? %>
                <%= button_to "Join Group", group_memberships_path(@group), method: :post, class:"btn btn-dark text-uppercase p-3" %>
            <% end%>
            </small>

        </div>
        <%# --------group info ends ----------%>
        <%# --------members start ----------%>
        <div class="card container card shadow p-3 mb-5 bg-white rounded m-4" >

            <h1>Members:</h1>

            <% if @members.present? %>
                <% @members.each do |member| %>
                <p><%= member.user.full_name %> </p>
                <button class="ui basic button"><i class="icon user"></i><%= link_to "Profile", user_path(member), style:"text-decoration: none; color: black" %></button>
                <% end %>
            <% end %>

        </div>
            <%# --------members ends ----------%>



            <%# right ends %>
            <%# right ends %>
            <%# right ends %>
            <%# right ends %>
            <%# right ends %>
        </div>
    </div>
</div>












<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
<%# layout %>
  <div class="container">

<div class="container">
 <div class="card container card shadow p-3 mb-5 bg-white rounded" style="width: 40rem;">
    <h2><%= @group.title %></h2>
    <p><%= @group.description %></p>
    <p>Admin: <%= @group.user.first_name %></p>
    <span><i class="map pin icon"></i>Vancouver BC, Canada</span>
    <br>
     <small>
      <% if @membership.present? %>
         <%= button_to "Leave Group", membership_path(@membership), method: :delete, class:"ui red button btn btn-danger text-uppercase p-3" %>
         <% elsif user_signed_in? %>
        <%= button_to "Join Group", group_memberships_path(@group), method: :post, class:"btn btn-dark text-uppercase p-3" %>
     <% end%>
    </small>

</div>



<div class="container" >
<div class="card container card shadow p-3 mb-5 bg-white rounded" style="width: 40rem;">

    <h1>Members:</h1>

    <% if @members.present? %>
        <% @members.each do |member| %>
        <p><%= member.user.full_name %> </p>
        <button class="ui basic button"><i class="icon user"></i><%= link_to "Profile", user_path(member), style:"text-decoration: none; color: black" %></button>
        <% end %>
    <% end %>


</div>
</div>




<% if @membership.present? %>
<div class="container">
<div class="container card shadow p-3 mb-5 bg-white rounded" style="width: 40rem;">
    <h2>New Post</h2>
        <%= form_with(model:[@group, @group_post]) do |f| %>
         <div class="form-group">
        <%= f.label :body %>
        <br>
        <%= f.rich_text_area :body, cols: 50, rows: 5, class:"form-control" %>
        <br>
        </div>
         <div class="form-group">
        <%= f.label :image %>
        <br>
        <%= f.file_field :image, class:"form-control" %> 
         <%= content_tag(:i, nil, id: 'audio-record-button', class:'bi bi-mic microphone-icon') %>
        <br>
        </div>
    <br>
        <%= f.submit "Post", class:"ui primary button" %>
    <br>
    <% end %>
</div>
</div>


    <div class="">
    <% @group_posts.each do |group_post| %>
    <div class="container card shadow p-3 mb-5 bg-white rounded" style="width: 40rem;">
        <div class="ui comments">
        <div class="comment">
                <a class="avatar">
                <img src="https://i.pravatar.cc/">
                </a>
                <div class="content">
                <a class="author">
                <%= link_to user_path(group_post.user.id), class:"text-dark " do %>
                <%= group_post.user.full_name%>
                <% end %>
                </a>
                <div class="metadata">
                    <span class="date"><%= time_ago_in_words(group_post.created_at) %> ago</span>
                </div>
                </div>
        </div>
        </div>
        <div><%= group_post.body %></div>
        <%   if group_post.image.attached? && group_post.image.content_type.in?(%w[image/jpeg image/png image/gif])%>
             <%= link_to image_tag(group_post.image_as_thumbnail), group_post.image %>
        <% end %>
       <br>
        <small>
        <% like = group_post.likes.find_by(user: current_user) %>
            <% if like.present? %>

                <%= button_to "❤️", like_path(like), method: :delete, class:"ui icon button" %>
                
                <% elsif user_signed_in? %>
               



                <%= button_to "🤍", group_group_post_likes_path(@group.id, group_post.id), method: :post, class:"ui icon button" %>



            <% end%>
        </small>

        </hr>
        </hr>
       


        <div class="">
            
             <%= form_with(model:[@group, group_post, @comment]) do |f| %>
            <div class="form-group">
             <%= f.label "Leave a Comment" %>
             <br>
             <%= f.text_area :body, cols: 50, rows: 1, class:"form-control" %>
              <br>
             </div>
          <%= f.submit "Post", class:"ui primary button" %>

            <div class="ui comments">
               
    <%# Comment Section starts%>
        <% if group_post.comments.any? %>
            <h3 class="ui dividing header"></h3>
             <% group_post.comments.each do |comment|%>

            <div class="comment">
                <a class="avatar">
                <img src="https://i.pravatar.cc/">
                </a>
                <div class="content">
                <a class="author">
                <%= link_to user_path(comment.user.id) do %>
                <%= comment.user.full_name%></a>
                <% end %>
               
                <div class="metadata">
                    <span class="date"><%= time_ago_in_words(comment.created_at) %> ago</span>
                </div>
                <div class="text">
                    <%= comment.body %>
                </div>
                </div>
            </div>
            <% end %>
        <% end %>
    <%# Comment Section ends %>



</div>
    <% end %>
        </div>
    </div>
<% end %>
</div>


<% end%>

</div>



  </div>


</div>





